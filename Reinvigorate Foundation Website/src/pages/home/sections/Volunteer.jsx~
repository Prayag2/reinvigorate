import Title from "/src/components/Title"
import Wrapper from "/src/components/Wrapper"
import Input from "/src/components/Input"
import Textarea from "/src/components/Textarea"
import MultiSelect from "/src/components/MultiSelect"
import Button from "/src/components/Button"
import {InitiativeContext} from "/src/contexts/InitiativeContext"

import {useContext, useEffect, useState} from "react"

function Volunteer() {
    const {initiatives} = useContext(InitiativeContext);
    const [initiativeChoices, setInitiativeChoices] = useState([]);

    useEffect(()=>{
	setInitiativeChoices(()=>initiatives.map(ini => ini.name));
    }, [initiatives]);

    function submitForm(e) {
	e.preventDefault();

	const formData = new FormData(document.querySelector("#volunteerForm"));
	const selectedInitiatives = document.querySelector("#initiative").dataset.value;

	const name = formData.get("name");
	const email = formData.get("email");
	const phone = formData.get("phone");
	const experience = formData.get("experience");
	console.log(`${name} just applied for ${selectedInitiatives}. Their contact details are\n${phone} and ${email}.`)
    }

    return (
	<Wrapper id="volunteer" className="text-center py-10 scroll-mt-[10vh]">
	    <form id="volunteerForm" onSubmit={e => submitForm(e)}>
		<Title text="Volunteer" fancy/>
		<Input name="name" placeholder="John Doe" label="Your Name"/>
		<div className="flex flex-wrap md:flex-nowrap md:space-x-4">
		    <Input className="w-full" name="email" type="email" placeholder="johndoe@gmail.com" label="Email Adress"/>
		    <Input className="w-full" name="phone" type="tel" placeholder="+91XXXXXXXXXX" label="Phone Number"/>
		</div>
		<MultiSelect
		    label="Select one or more initiatives"
		    placeholder="Select initiative"
		    name="initiative"
		    choices={initiativeChoices} />
		<Textarea className="mt-2" name="experience" placeholder="Describe your experience" label="Have you ever volunteered before? If yes, describe your experience!"/>

		<Button className="w-full" text="Submit"/>
	    </form>
	</Wrapper>
    )
}

export default Volunteer;
