import { Routes, Route } from "react-router-dom"
import { useState, useEffect } from "react"

import Initiative from "/src/pages/initiative"

function InitiativeRoutes() {
    
    const [initiatives, setInitiatives] = useState([]);
    useEffect(() => {
	async function fetchData() {
	    const initiativesResponse = await fetch("/data/initiatives.json");
	    const initiativesJSON = await initiativesResponse.json();
	    setInitiatives(initiativesJSON);
	}
	fetchData();
    }, []);

    return (
	<Routes>
	    {
		initiatives.map((ini, i) => {
		    ini.images = [...Array(parseInt(ini.imageCount)).keys()].map(i => `/images/initiatives/${ini.route}/${i+1}.png`)
		    return (<Route key={i} path={ini.route} element={
			       <Initiative
				   initiative={ini}
			       />
				   }/>)
		})
	    }
	    <Route path="*" element={ <h1>Initiative Not Found</h1> }/>
	</Routes>
    )
}

export default InitiativeRoutes;
